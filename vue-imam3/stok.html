<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manajemen Stok Bahan Ajar</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <header>
        <div>
            <a href="index.html">
                <span>SITTA UT</span>
            </a>
            <input id="menu-toggle" type="checkbox">
            <label for="menu-toggle"></label>
            <nav>
                <a href="index.html">Beranda</a>
                <a href="stok.html" class="active">Manajemen Stok</a>
                <a href="tracking.html">Tracking DO</a>
            </nav>
        </div>
    </header>

    <div class="container">
        <main id="app-stok">
            <section class="filter-box">
                <h3>Filter & Sortir</h3>
                <div class="filter-controls">
                    <div>
                        <label for="filterUpbjj">UT-Daerah:</label>
                        <select id="filterUpbjj" v-model="filterUPBJJ">
                            <option value="">Semua UPBJJ</option>
                            <option v-for="upbjj in upbjjList" :value="upbjj">{{ upbjj }}</option>
                        </select>
                    </div>

                    <div v-if="filterUPBJJ">
                        <label for="filterKategori">Kategori:</label>
                        <select id="filterKategori" v-model="filterKategori">
                            <option value="">Semua Kategori</option>
                            <option v-for="kategori in kategoriList" :value="kategori">{{ kategori }}</option>
                        </select>
                    </div>

                    <div>
                        <label for="sortBy">Urutkan Berdasarkan:</label>
                        <select id="sortBy" v-model="sortBy">
                            <option value="">Default</option>
                            <option value="judul">Judul (A-Z)</option>
                            <option value="stok">Stok (Terkecil)</option>
                            <option value="harga">Harga (Termurah)</option>
                        </select>
                    </div>

                    <div>
                        <input type="checkbox" id="filterReorder" v-model="filterReorder" style="width: auto; margin-right: 8px;">
                        <label for="filterReorder" style="display: inline;">Tampilkan yang perlu Re-Order</label>
                    </div>

                    <button @click="resetFilter" class="btn btn--primary" style="margin-left: auto;">Reset Filter</button>
                </div>
            </section>

            <section>
                <h3>Daftar Stok</h3>
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>Kode MK</th>
                                <th>Nama MK</th>
                                <th >Kategori</th>
                                <th>UT-Daerah</th>
                                <th>Lokasi Rak</th>
                                <th>Stok (Qty)</th>
                                <th>Safety</th>
                                <th>Status</th>
                                <th >Catatan</th>
                                <th>Aksi</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr v-for="item in filteredStok" :key="item.kode">
                                <td>{{ item.kode }}</td>
                                <td>{{ item.judul }}</td>
                                <td>{{ item.kategori }}</td>
                                <td>{{ item.upbjj }}</td>
                                <td>{{ item.lokasiRak }}</td>
                                <td>{{ item.qty }}</td>
                                <td>{{ item.safety }}</td>
                                <td>
                                    <span :class="getStatusClass(item)">{{ getStatus(item) }}</span>
                                </td>
                                <td class="wrap-text" v-html="item.catatanHTML"></td>
                                <td>
                                    <button class="btn btn--edit" @click="editStok(item)">Edit</button>
                                </td>
                            </tr>
                            <tr v-if="filteredStok.length === 0">
                                <td colspan="10">Data tidak ditemukan.</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <section class="form-section" style="margin-top: 20px;">
                <h3>{{ isEditing ? 'Edit Data Bahan Ajar' : 'Tambah Data Bahan Ajar Baru' }}</h3>
                <form @submit.prevent="handleSubmit">
                    <div>
                        <label for="newKode">Kode MK:</label>
                        <input type="text" id="newKode" v-model="stokForm.kode" :disabled="isEditing" required>
                    </div>
                    <div>
                        <label for="newJudul">Judul MK:</label>
                        <input type="text" id="newJudul" v-model="stokForm.judul" required>
                    </div>
                    <div>
                        <label for="newKategori">Kategori:</label>
                        <select id="newKategori" v-model="stokForm.kategori" required>
                            <option value="">Pilih Kategori</option>
                            <option v-for="kategori in kategoriList" :value="kategori">{{ kategori }}</option>
                        </select>
                    </div>
                    <div>
                        <label for="newUpbjj">UPBJJ:</label>
                        <select id="newUpbjj" v-model="stokForm.upbjj" required>
                            <option value="">Pilih UPBJJ</option>
                            <option v-for="upbjj in upbjjList" :value="upbjj">{{ upbjj }}</option>
                        </select>
                    </div>
                    <div>
                        <label for="newLokasi">Lokasi Rak:</label>
                        <input type="text" id="newLokasi" v-model="stokForm.lokasiRak">
                    </div>
                    <div>
                        <label for="newHarga">Harga:</label>
                        <input type="number" id="newHarga" v-model.number="stokForm.harga" required>
                    </div>
                    <div>
                        <label for="newQty">Kuantitas:</label>
                        <input type="number" id="newQty" v-model.number="stokForm.qty" required>
                    </div>
                    <div>
                        <label for="newSafety">Safety Stock:</label>
                        <input type="number" id="newSafety" v-model.number="stokForm.safety" required>
                    </div>
                    <div>
                        <label for="newCatatan">Catatan (HTML):</label>
                        <input type="text" id="newCatatan" v-model="stokForm.catatanHTML">
                    </div>
                    
                    <div style="display: flex; gap: 10px; margin-top: 16px;">
                        <button type="submit" class="btn btn--primary">{{ isEditing ? 'Update Stok' : 'Tambah Stok' }}</button>
                        <button type="button" class="btn btn--cancel" @click="cancelEdit" v-if="isEditing">Batal</button>
                    </div>
                </form>
            </section>
        </main>
        <footer style="color:black"><center>&copy; IMAM MA'SUM ( 051146712 ) </center></footer>

    </div>

    <script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
    <script src="js/stok-app.js"></script>
</body>
</html>